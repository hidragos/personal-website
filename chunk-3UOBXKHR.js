import{e as te,q as ne,r as re,u as oe,v as me}from"./chunk-NA3ZIS5Q.js";import"./chunk-X5YLR3NI.js";import{D as $,E as ee,k as L,l as b,n as O,o as H,s as J,u as K,v as W,w as X,y as Y,z as Z}from"./chunk-7V3KIK36.js";import{$ as P,S as k,X as N,_ as D,ca as U,ea as R,fa as j,ga as q,ha as G,ia as Q,ja as z,ua as ie,va as ae}from"./chunk-3ZVAZC7S.js";import"./chunk-2J4O7ELU.js";import"./chunk-MKT6AYFA.js";import"./chunk-LUYJJVFE.js";import{m as V,r as T}from"./chunk-F6VEFF7R.js";import{Fb as i,Gb as a,Hb as M,Kb as y,Pb as S,Ub as x,Xa as C,Xb as A,Yb as B,Zb as E,a as I,ab as t,bb as h,bc as r,cc as d,dc as f,ha as _,jc as w,oc as m,pc as l,ra as g,sa as v,vb as F,xb as s}from"./chunk-TLNYMMAR.js";import"./chunk-ODN5LVDJ.js";var ce=["fileInput"];function se(o,le){o&1&&(i(0,"mat-error"),r(1),m(2,"transloco"),a()),o&2&&(t(),f(" ",l(2,1,"account.manage.errors.usernameRequired")," "))}function pe(o,le){o&1&&(i(0,"mat-error"),r(1),m(2,"transloco"),a()),o&2&&(t(),f(" ",l(2,1,"account.manage.errors.usernameMinlength")," "))}var De=(()=>{class o{fb;snackBar;supabaseAuthService;accountForm;isSubmitting=!1;subscriptions=new I;fileInput;user;constructor(c,n,e){this.fb=c,this.snackBar=n,this.supabaseAuthService=e}ngOnInit(){this.accountForm=this.fb.group({username:["",[b.required,b.minLength(3)]]}),this.loadUserData()}ngOnDestroy(){this.subscriptions.unsubscribe()}loadUserData(){this.user={email:this.supabaseAuthService.user()?.email||"",avatarUrl:this.supabaseAuthService.user()?.user_metadata.avatar_url||"",fullName:this.supabaseAuthService.user()?.user_metadata.full_name||"",profileImage:null},this.accountForm.patchValue({username:this.user.fullName})}triggerFileInput(){this.fileInput.nativeElement.click()}onFileSelected(c){let n=c.target.files?.[0];if(n){let e=new FileReader;e.onload=()=>{this.user.profileImage=e.result},e.readAsDataURL(n)}}onSubmit(){if(this.accountForm.invalid)return;this.isSubmitting=!0;let n={username:this.accountForm.value.username,profileImage:this.user.profileImage};setTimeout(()=>{this.snackBar.open("Account updated successfully!","Close",{duration:3e3}),this.accountForm.markAsPristine(),this.isSubmitting=!1},2e3)}static \u0275fac=function(n){return new(n||o)(h(X),h(oe),h(te))};static \u0275cmp=_({type:o,selectors:[["app-manage-account"]],viewQuery:function(n,e){if(n&1&&A(ce,5),n&2){let u;B(u=E())&&(e.fileInput=u.first)}},standalone:!0,features:[w],decls:39,vars:27,consts:[["fileInput",""],[1,"page-content"],["appearance","outlined",1,"max-w-2xl","mx-auto"],[1,"text-center"],[1,"flex","flex-col","gap-4",3,"ngSubmit","formGroup"],[1,"flex","flex-col","items-center"],["alt","Profile Picture",1,"rounded-full","w-32","h-32","mat-elevation-z2","mb-2",3,"src"],["mat-button","","type","button",3,"click","matTooltip"],["type","file","accept","image/*",1,"hidden",3,"change"],[1,"text-xs"],["appearance","outline",1,"w-full"],["matInput","","formControlName","username"],[4,"ngIf"],["matInput","","disabled","",3,"value"],[1,"flex","justify-end"],["mat-flat-button","","color","primary","type","submit",3,"disabled"]],template:function(n,e){if(n&1){let u=y();i(0,"div",1)(1,"mat-card",2)(2,"mat-card-header",3)(3,"mat-card-title"),r(4),m(5,"transloco"),a(),i(6,"mat-card-subtitle"),r(7),m(8,"transloco"),a()(),i(9,"mat-card-content")(10,"form",4),S("ngSubmit",function(){return g(u),v(e.onSubmit())}),i(11,"div",5),M(12,"img",6),i(13,"button",7),m(14,"transloco"),S("click",function(){return g(u),v(e.triggerFileInput())}),i(15,"mat-icon"),r(16,"edit"),a(),r(17),m(18,"transloco"),a(),i(19,"input",8,0),S("change",function(ue){return g(u),v(e.onFileSelected(ue))}),a()(),i(21,"span",9),r(22),m(23,"transloco"),a(),i(24,"mat-form-field",10),M(25,"input",11),F(26,se,3,3,"mat-error",12)(27,pe,3,3,"mat-error",12),a(),i(28,"span",9),r(29),m(30,"transloco"),a(),i(31,"mat-form-field",10),M(32,"input",13),a(),i(33,"div",14)(34,"button",15)(35,"mat-icon"),r(36,"save"),a(),r(37),m(38,"transloco"),a()()()()()()}if(n&2){let u,p;t(4),d(l(5,13,"account.manage.title")),t(3),d(l(8,15,"account.manage.subtitle")),t(3),s("formGroup",e.accountForm),t(2),s("src",e.user.profileImage||e.user.avatarUrl,C),t(),x("matTooltip",l(14,17,"account.manage.changePicture")),t(4),f(" ",l(18,19,"account.manage.changePicture")," "),t(5),d(l(23,21,"account.manage.name")),t(4),s("ngIf",(u=e.accountForm.get("username"))==null?null:u.hasError("required")),t(),s("ngIf",(p=e.accountForm.get("username"))==null?null:p.hasError("minlength")),t(2),d(l(30,23,"account.manage.email")),t(3),s("value",e.user.email),t(2),s("disabled",e.accountForm.pristine||e.isSubmitting),t(3),f(" ",l(38,25,"account.manage.save")," ")}},dependencies:[T,V,Y,J,L,O,H,K,W,z,R,q,Q,G,j,ee,$,Z,re,ne,N,k,P,D,me,ae,ie,U]})}return o})();export{De as AccountManagerComponent};
