import{b as oe,c as me}from"./chunk-6Q5S2C2N.js";import{B as te,P as ne,Q as re,h as L,i as b,j as O,k as H,n as J,p as K,q as W,r as X,t as Y,u as Z,x as $,y as ee}from"./chunk-646TYEBQ.js";import"./chunk-X5YLR3NI.js";import{$ as P,S as k,X as N,_ as D,ca as U,fa as R,ga as j,ha as q,ia as G,ja as Q,ka as z,va as ie,wa as ae}from"./chunk-RQO3APZL.js";import"./chunk-2J4O7ELU.js";import"./chunk-MKT6AYFA.js";import"./chunk-LUYJJVFE.js";import{m as V,r as T}from"./chunk-F6VEFF7R.js";import{Fb as i,Gb as a,Hb as M,Kb as y,Pb as S,Ub as x,Xa as C,Xb as A,Yb as B,Zb as E,a as I,ab as t,bb as h,bc as r,cc as d,dc as f,ha as _,jc as w,oc as m,pc as l,ra as g,sa as v,vb as F,xb as s}from"./chunk-TLNYMMAR.js";import"./chunk-ODN5LVDJ.js";var ce=["fileInput"];function se(o,le){o&1&&(i(0,"mat-error"),r(1),m(2,"transloco"),a()),o&2&&(t(),f(" ",l(2,1,"account.manage.errors.usernameRequired")," "))}function pe(o,le){o&1&&(i(0,"mat-error"),r(1),m(2,"transloco"),a()),o&2&&(t(),f(" ",l(2,1,"account.manage.errors.usernameMinlength")," "))}var De=(()=>{class o{fb;snackBar;supabaseAuthService;accountForm;isSubmitting=!1;subscriptions=new I;fileInput;user;constructor(c,n,e){this.fb=c,this.snackBar=n,this.supabaseAuthService=e}ngOnInit(){this.accountForm=this.fb.group({username:["",[b.required,b.minLength(3)]]}),this.loadUserData()}ngOnDestroy(){this.subscriptions.unsubscribe()}loadUserData(){this.user={email:this.supabaseAuthService.user()?.email||"",avatarUrl:this.supabaseAuthService.user()?.user_metadata.avatar_url||"",fullName:this.supabaseAuthService.user()?.user_metadata.full_name||"",profileImage:null},this.accountForm.patchValue({username:this.user.fullName})}triggerFileInput(){this.fileInput.nativeElement.click()}onFileSelected(c){let n=c.target.files?.[0];if(n){let e=new FileReader;e.onload=()=>{this.user.profileImage=e.result},e.readAsDataURL(n)}}onSubmit(){if(this.accountForm.invalid)return;this.isSubmitting=!0;let n={username:this.accountForm.value.username,profileImage:this.user.profileImage};setTimeout(()=>{this.snackBar.open("Account updated successfully!","Close",{duration:3e3}),this.accountForm.markAsPristine(),this.isSubmitting=!1},2e3)}static \u0275fac=function(n){return new(n||o)(h(X),h(oe),h(te))};static \u0275cmp=_({type:o,selectors:[["app-manage-account"]],viewQuery:function(n,e){if(n&1&&A(ce,5),n&2){let u;B(u=E())&&(e.fileInput=u.first)}},standalone:!0,features:[w],decls:38,vars:27,consts:[["fileInput",""],["appearance","outlined"],[1,"text-center"],[1,"flex","flex-col","gap-4",3,"ngSubmit","formGroup"],[1,"flex","flex-col","items-center"],["alt","Profile Picture",1,"rounded-full","w-32","h-32","mat-elevation-z2","mb-2",3,"src"],["mat-button","","type","button",3,"click","matTooltip"],["type","file","accept","image/*",1,"hidden",3,"change"],[1,"text-xs"],["appearance","outline",1,"w-full"],["matInput","","formControlName","username"],[4,"ngIf"],["matInput","","disabled","",3,"value"],[1,"flex","justify-end"],["mat-flat-button","","color","primary","type","submit",3,"disabled"]],template:function(n,e){if(n&1){let u=y();i(0,"mat-card",1)(1,"mat-card-header",2)(2,"mat-card-title"),r(3),m(4,"transloco"),a(),i(5,"mat-card-subtitle"),r(6),m(7,"transloco"),a()(),i(8,"mat-card-content")(9,"form",3),S("ngSubmit",function(){return g(u),v(e.onSubmit())}),i(10,"div",4),M(11,"img",5),i(12,"button",6),m(13,"transloco"),S("click",function(){return g(u),v(e.triggerFileInput())}),i(14,"mat-icon"),r(15,"edit"),a(),r(16),m(17,"transloco"),a(),i(18,"input",7,0),S("change",function(ue){return g(u),v(e.onFileSelected(ue))}),a()(),i(20,"span",8),r(21),m(22,"transloco"),a(),i(23,"mat-form-field",9),M(24,"input",10),F(25,se,3,3,"mat-error",11)(26,pe,3,3,"mat-error",11),a(),i(27,"span",8),r(28),m(29,"transloco"),a(),i(30,"mat-form-field",9),M(31,"input",12),a(),i(32,"div",13)(33,"button",14)(34,"mat-icon"),r(35,"save"),a(),r(36),m(37,"transloco"),a()()()()()}if(n&2){let u,p;t(3),d(l(4,13,"account.manage.title")),t(3),d(l(7,15,"account.manage.subtitle")),t(3),s("formGroup",e.accountForm),t(2),s("src",e.user.profileImage||e.user.avatarUrl,C),t(),x("matTooltip",l(13,17,"account.manage.changePicture")),t(4),f(" ",l(17,19,"account.manage.changePicture")," "),t(5),d(l(22,21,"account.manage.name")),t(4),s("ngIf",(u=e.accountForm.get("username"))==null?null:u.hasError("required")),t(),s("ngIf",(p=e.accountForm.get("username"))==null?null:p.hasError("minlength")),t(2),d(l(29,23,"account.manage.email")),t(3),s("value",e.user.email),t(2),s("disabled",e.accountForm.pristine||e.isSubmitting),t(3),f(" ",l(37,25,"account.manage.save")," ")}},dependencies:[T,V,Y,J,L,O,H,K,W,z,R,q,Q,G,j,ee,$,Z,re,ne,N,k,P,D,me,ae,ie,U]})}return o})();export{De as AccountManagerComponent};
