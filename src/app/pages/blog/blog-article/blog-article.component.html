@if(articleForm){
<form [formGroup]="articleForm" (ngSubmit)="onSubmit()" class="flex flex-col">
  <mat-card appearance="outlined" class="h-full" *ngIf="loaded">
    <mat-card-content>
      <mat-card-header>
        <mat-card-title>
          <div class="flex flex-row justify-between flex-wrap">
            <button type="button" mat-icon-button (click)="back()">
              <mat-icon>arrow_back</mat-icon>
            </button>
            <textarea
              type="text"
              class="page-title post-input flex self-center text-center post-input flex-1 text-3xl font-light"
              matInput
              #input
              [appTogglablePlaceholder]="'Title'"
              formControlName="title"
              [maxLength]="100"
            >
            </textarea>

            <span
              *ngIf="!edit"
              style="transform: translateX(-24px)"
              [ngClass]="{
                'opacity-1': articleForm.dirty,
                'opacity-0': articleForm.pristine
              }"
            >
              *
            </span>
            <div
              class="flex flex-col text-end items-end justify-end"
              *ngIf="edit"
            >
              <span
                [ngClass]="{
                  'opacity-50': articleForm.dirty,
                  'opacity-0': articleForm.pristine
                }"
              >
                *
              </span>
              <span class="self-end text-xs opacity-50">
                {{ titleFormValue.length }} / 100
              </span>
            </div>
            <div *ngIf="!edit">
              <button
                type="button"
                mat-icon-button
                [matMenuTriggerFor]="menu"
                aria-label="3-dot menu"
              >
                <mat-icon>more_vert</mat-icon>
              </button>
              <mat-menu #menu="matMenu">
                <a mat-menu-item (click)="toggleEdit()">Edit</a>
              </mat-menu>
            </div>
          </div>
        </mat-card-title>
      </mat-card-header>

      <textarea
        class="post-input"
        style="min-height: 40dvh"
        matInput
        [autofocus]="true"
        formControlName="content"
        [appTogglablePlaceholder]="'Content'"
        [maxLength]="2048"
      ></textarea>

      <span
        class="self-end text-xs opacity-50 text-end block mb-6"
        *ngIf="edit"
      >
        {{ contentFormValue.length }} / 2048
      </span>
      @if (edit) {
      <div class="border-b border-primary-container"></div>
      <div class="flex justify-between gap-4 pt-4">
        <div class="flex justify-start gap-4">
          <button
            (click)="onDelete()"
            *ngIf="id"
            color="warn"
            mat-button
            type="button"
          >
            Delete
          </button>
          <button
            *ngIf="id"
            mat-flat-button
            type="button"
            (click)="onRestore()"
            [disabled]="articleForm.pristine"
          >
            Restore
          </button>
        </div>
        <div class="flex justify-end gap-4">
          <button mat-flat-button type="button" (click)="toggleEdit()">
            Preview
          </button>

          <button mat-flat-button [disabled]="articleForm.pristine">
            Save
          </button>
        </div>
      </div>
      }
      <div class="flex flex-col items-end justify-end pt-4" *ngIf="submitTry">
        <p class="color-error" *ngIf="articleForm.get('title')?.invalid">
          * Title is required
        </p>
        <p class="color-error" *ngIf="articleForm.get('content')?.invalid">
          * Content is required
        </p>
      </div>
    </mat-card-content>
  </mat-card>
</form>
}
